# 🧪 테스트 작성 가이드 (Test Writing Guide)

> **목표:** 이 문서는 '테스트 설계 에이전트'와 '테스트 코드 작성 에이전트'가 프로젝트의 테스트를 설계하고 구현하는 데 필요한 모범 사례, 원칙, 그리고 프로젝트의 테스트 철학을 제공합니다.

---

## 1. 좋은 테스트의 특징

- **빠른 실행 (Fast):** 테스트는 빠르게 실행되어야 합니다. 느린 테스트는 개발 흐름을 방해합니다.
- **독립성 (Independent):** 각 테스트는 다른 테스트의 결과에 의존하지 않아야 합니다. 테스트 순서에 관계없이 항상 동일한 결과를 보장해야 합니다.
- **반복 가능성 (Repeatable):** 어떤 환경에서든(개발 머신, CI 서버 등) 항상 동일한 결과를 내야 합니다.
- **자체 검증 (Self-Validating):** 테스트는 성공 또는 실패를 명확하게 알려주어야 합니다. 수동으로 결과를 확인하는 과정이 없어야 합니다.
- **적시성 (Timely):** 테스트는 실제 코드를 작성하기 직전(TDD) 또는 기능 구현과 동시에 작성되어야 합니다.

---

## 2. 테스트 작성 원칙 (FIRST Principles)

- **F**ast (빠르게): 테스트는 빠르게 실행되어야 합니다.
- **I**ndependent (독립적으로): 각 테스트는 독립적이어야 합니다.
- **R**epeatable (반복 가능하게): 테스트는 반복 가능해야 합니다.
- **S**elf-Validating (자체 검증): 테스트는 자체적으로 성공/실패를 알려야 합니다.
- **T**horough (철저하게): 테스트는 충분히 철저해야 합니다.

---

## 3. 테스트 유형 및 역할

- **단위 테스트 (Unit Test):**
  - **대상:** 애플리케이션의 가장 작은 단위(함수, 클래스, 컴포넌트)
  - **목표:** 각 단위가 독립적으로 올바르게 동작하는지 검증
  - **특징:** 빠르고, 격리되어 있으며, Mocking/Stubbing을 적극 활용
- **통합 테스트 (Integration Test):**
  - **대상:** 여러 단위 또는 모듈 간의 상호작용
  - **목표:** 컴포넌트들이 함께 작동할 때 올바르게 동작하는지 검증
  - **특징:** 실제 의존성(DB, API 등)을 사용하거나 Mocking Service Worker(MSW)와 같은 도구로 실제에 가깝게 모킹
- **E2E 테스트 (End-to-End Test):**
  - **대상:** 사용자 관점에서 전체 애플리케이션 흐름
  - **목표:** 실제 사용자가 애플리케이션을 사용하는 것처럼 동작하는지 검증
  - **특징:** 가장 느리고, 비용이 많이 들지만, 사용자 경험을 보장하는 데 중요

---

## 4. 우리 프로젝트의 테스트 철학 및 주의사항

- **TDD(Test-Driven Development) 지향:** 테스트 설계는 TDD의 'Red' 단계임을 명확히 인지하고, 구현 관점에서의 테스트를 지향합니다. 테스트가 먼저 실패하고, 그 테스트를 통과시키기 위한 코드를 작성합니다.
- **단일 책임 원칙 (SRP) 준수:** 하나의 테스트는 오직 하나의 특정 동작이나 시나리오만을 검증하도록 설계합니다. 여러 기능을 한 테스트에서 검증하지 않습니다.
- **구현 세부사항 노출 지양:** 테스트는 '무엇을' 검증하는지에 집중하고, '어떻게' 구현되었는지에 대한 세부사항에 너무 깊이 의존하지 않도록 합니다. (단, 구현 관점의 테스트는 허용)
- **사용자 관점 테스트:** 테스트는 내부 구현의 세부사항보다는 **사용자 관점에서 기능의 동작을 검증**하는 데 초점을 맞춥니다. (예: 버튼 클릭 시 화면 변화, API 호출 결과 등)
- **최소 모킹 전략:** 순수 함수(Pure Function)는 모킹하지 않고 실제 함수를 호출하여 테스트합니다. 외부 의존성(API, DB 등)만 필요한 경우에 한해 최소한으로 모킹하여 테스트의 신뢰성을 높입니다.
- **DAMP over DRY:** 테스트 코드에서는 일반적인 프로덕션 코드와 달리, 'Don't Repeat Yourself (DRY)' 원칙보다 'Descriptive And Meaningful Phrases (DAMP)' 원칙을 우선합니다. 테스트의 가독성과 독립성을 위해 약간의 중복은 허용합니다.
- **의미 있는 커버리지:** 단순히 코드 라인 커버리지 숫자를 높이는 것보다, 핵심 비즈니스 로직과 중요한 사용자 시나리오에 대한 테스트 커버리지를 확보하는 데 집중합니다.
- **`setupTests.ts` 활용:** `src/setupTests.ts`와 같이 공통으로 사용하는 테스트 설정 파일이 있다면, 중복된 구성을 피하고 해당 파일을 적극 활용합니다.
- **테스트 설명의 구체성:** `describe` 및 `it` 블록의 설명은 **'무엇을', '어떤 조건에서', '어떤 결과'**를 기대하는지 명확하게 작성합니다. (예: `it('유효한 이메일 입력 시, 에러 메시지가 사라져야 한다')`)

---

## 5. 테스트 코드 구조화 패턴 (Test Code Structuring Patterns)

> (테스트 코드의 가독성과 유지보수성을 높이기 위한 일반적인 구조화 패턴입니다.)

### 5.1. AAA 패턴 (Arrange-Act-Assert)

- **Arrange (준비):** 테스트를 실행하기 위한 모든 전제 조건과 입력값을 설정합니다. (객체 초기화, Mock 설정, 데이터 준비 등)
- **Act (실행):** 테스트 대상 시스템(System Under Test, SUT)의 특정 동작을 실행합니다. (함수 호출, 이벤트 발생 등)
- **Assert (단언):** 실행 결과가 예상과 일치하는지 검증합니다. (반환 값 확인, 상태 변화 확인, Mock 호출 여부 확인 등)

### 5.2. Given-When-Then 패턴 (BDD 스타일)

- AAA 패턴과 유사하지만, 좀 더 비즈니스 도메인 언어에 가깝게 테스트 시나리오를 설명하는 데 중점을 둡니다.
- **Given (주어진 상황):** 테스트 시작 전의 시스템 상태 또는 전제 조건 (Arrange와 유사).
- **When (행동):** 테스트 대상 시스템에 가해지는 특정 이벤트 또는 행동 (Act와 유사).
- **Then (기대 결과):** 행동 후 시스템이 보여야 하는 예상되는 결과 (Assert와 유사).

---

## 6. Kent Beck의 테스트 원칙 (간략 요약)

- **Simple Design:** 테스트는 코드를 단순하게 유지하는 데 도움을 줍니다.
- **Test First:** 코드를 작성하기 전에 테스트를 작성합니다.
- **Small Steps:** 작은 단위로 테스트를 작성하고, 작은 단위로 코드를 구현합니다.
- **Feedback:** 테스트는 즉각적인 피드백을 제공하여 개발자가 자신감을 가지고 변경할 수 있도록 합니다.

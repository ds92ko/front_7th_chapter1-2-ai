# 테스트 명세서: 반복 종료일 입력 제한

**작성자**: Artemis (테스트 설계자)  
**작성일**: 2025-10-31  
**Session ID**: tdd_2025-11-01_002  
**참조 문서**: `feature_spec.md`

---

## 1. 테스트 전략

### 1.1 테스트 목표

- 반복 종료일 입력 필드에 `max` 속성이 올바르게 적용되었는지 검증
- `max` 속성 값이 정확히 `'2025-12-31'`인지 확인
- 기존 반복 일정 생성 기능이 영향받지 않았는지 검증

### 1.2 테스트 범위

- **포함**: UI 컴포넌트의 속성 검증
- **제외**: 브라우저의 날짜 선택기 동작 (브라우저 자체 기능)

### 1.3 테스트 레벨

- **단위 테스트**: 입력 필드의 `max` 속성 검증

---

## 2. 테스트 케이스

### 2.1 단위 테스트: 반복 종료일 입력 필드 속성 검증

#### TC-001: 반복 종료일 필드에 max 속성이 올바르게 설정되었는지 확인

**목적**: 반복 종료일 입력 필드가 HTML5 `max` 속성을 가지며, 그 값이 `'2025-12-31'`인지 검증

**전제 조건**:

- 일정 추가 폼이 열려 있음
- 반복 유형이 선택됨 (none이 아닌 값)

**테스트 단계**:

1. `App` 컴포넌트를 렌더링한다.
2. "일정 추가" 버튼을 클릭하여 폼을 연다.
3. 반복 유형 셀렉트박스를 찾아 'weekly'를 선택한다.
4. "반복 종료일" 레이블을 가진 입력 필드를 찾는다.
5. 해당 입력 필드의 `<input>` 요소를 찾는다.
6. `max` 속성이 존재하는지 확인한다.
7. `max` 속성의 값이 `'2025-12-31'`인지 확인한다.

**예상 결과**:

- `max` 속성이 존재함
- `max` 속성의 값이 정확히 `'2025-12-31'`임

**중요도**: High  
**우선순위**: P0

---

#### TC-002: 반복 종료일 필드의 max 속성이 모든 반복 유형에서 동일하게 적용되는지 확인

**목적**: 반복 유형('daily', 'weekly', 'monthly', 'yearly')에 관계없이 `max` 속성이 동일하게 적용되는지 검증

**전제 조건**:

- 일정 추가 폼이 열려 있음

**테스트 단계**:
각 반복 유형('daily', 'weekly', 'monthly', 'yearly')에 대해:

1. `App` 컴포넌트를 렌더링한다.
2. "일정 추가" 버튼을 클릭하여 폼을 연다.
3. 반복 유형을 선택한다.
4. "반복 종료일" 입력 필드를 찾는다.
5. `max` 속성이 `'2025-12-31'`인지 확인한다.

**예상 결과**:

- 모든 반복 유형에서 `max` 속성 값이 `'2025-12-31'`임

**중요도**: Medium  
**우선순위**: P1

---

### 2.2 통합 테스트: 반복 일정 생성 기능 정상 작동 확인

#### TC-003: 2025-12-31 이전의 날짜로 반복 일정을 생성할 수 있는지 확인

**목적**: `max` 속성 추가 후에도 기존 반복 일정 생성 기능이 정상 작동하는지 검증

**전제 조건**:

- 일정 추가 폼이 열려 있음
- Mock API가 정상 작동함

**테스트 단계**:

1. `App` 컴포넌트를 렌더링한다.
2. "일정 추가" 버튼을 클릭하여 폼을 연다.
3. 일정 정보 입력:
   - 제목: "주간 회의"
   - 날짜: "2025-11-01"
   - 시작 시간: "10:00"
   - 종료 시간: "11:00"
   - 반복 유형: "weekly"
   - 반복 간격: 1
   - 반복 종료일: "2025-12-31"
4. "일정 추가" 버튼을 클릭하여 저장한다.
5. API 호출이 성공적으로 이루어지는지 확인한다.
6. "일정 로딩 완료!" 메시지가 표시되는지 확인한다.
7. 생성된 반복 일정이 캘린더에 표시되는지 확인한다.

**예상 결과**:

- 반복 일정이 성공적으로 생성됨
- 2025-11-01부터 2025-12-31까지의 매주 금요일에 일정이 표시됨
- 오류 없이 정상 작동함

**중요도**: High  
**우선순위**: P0

---

## 3. 테스트 데이터

### 3.1 반복 유형별 테스트 데이터

| 반복 유형 | 시작 날짜  | 반복 간격 | 반복 종료일 | 예상 생성 개수 |
| --------- | ---------- | --------- | ----------- | -------------- |
| daily     | 2025-12-01 | 1         | 2025-12-31  | 31             |
| weekly    | 2025-11-01 | 1         | 2025-12-31  | 9              |
| monthly   | 2025-10-15 | 1         | 2025-12-31  | 3              |
| yearly    | 2025-01-01 | 1         | 2025-12-31  | 1              |

---

## 4. 테스트 환경

### 4.1 테스트 도구

- **테스트 프레임워크**: Vitest
- **렌더링 라이브러리**: React Testing Library
- **Assertion 라이브러리**: Vitest의 `expect`
- **Mock 도구**: Mock Service Worker (MSW)

### 4.2 테스트 설정

- **시스템 시간**: `vi.setSystemTime(new Date('2025-10-01'))`
- **Mock API**: MSW handlers 사용

---

## 5. 테스트 파일 구조

### 5.1 테스트 파일 위치

- **파일 경로**: `src/__tests__/unit/easy.repeatEndDateLimit.spec.ts`
- **분류**: Unit Test (Easy)

### 5.2 테스트 파일 구조

```typescript
describe('반복 종료일 입력 제한', () => {
  describe('TC-001: max 속성 검증', () => {
    it('반복 종료일 필드에 max 속성이 2025-12-31로 설정되어 있어야 한다', async () => {
      // 테스트 구현
    });
  });

  describe('TC-002: 반복 유형별 max 속성 검증', () => {
    it.each(['daily', 'weekly', 'monthly', 'yearly'])(
      '%s 반복 유형에서도 max 속성이 2025-12-31이어야 한다',
      async (repeatType) => {
        // 테스트 구현
      }
    );
  });

  describe('TC-003: 반복 일정 생성 기능 검증', () => {
    it('2025-12-31을 반복 종료일로 설정하여 일정을 생성할 수 있어야 한다', async () => {
      // 테스트 구현
    });
  });
});
```

---

## 6. 테스트 구현 가이드라인

### 6.1 테스트 작성 원칙

1. **명확한 테스트 이름**: 테스트 케이스의 목적이 명확히 드러나도록 작성
2. **단일 책임**: 각 테스트는 하나의 기능만 검증
3. **독립성**: 각 테스트는 다른 테스트에 영향을 주지 않음
4. **반복 가능성**: 언제 실행해도 동일한 결과
5. **빠른 실행**: 불필요한 대기 시간 최소화

### 6.2 React Testing Library 쿼리 우선순위

1. `getByLabelText`: 레이블을 통해 입력 필드 찾기 (최우선)
2. `getByRole`: role 속성을 통해 요소 찾기
3. `getByText`: 텍스트 내용으로 요소 찾기

### 6.3 입력 필드 접근 방법

```typescript
// 1. TextField 컴포넌트 찾기 (Material-UI)
const repeatEndDateInput = screen.getByLabelText('반복 종료일');

// 2. 실제 <input> 요소 접근
// Material-UI TextField는 내부에 <input>을 포함하므로,
// getByLabelText가 반환하는 것이 실제 <input> 요소임

// 3. max 속성 검증
expect(repeatEndDateInput).toHaveAttribute('max', '2025-12-31');
```

---

## 7. 예상 테스트 결과

### 7.1 Red Phase (초기)

- **TC-001**: ❌ FAIL - `max` 속성이 존재하지 않음
- **TC-002**: ❌ FAIL - `max` 속성이 존재하지 않음
- **TC-003**: ✅ PASS - 기존 기능은 정상 작동 (변경 전에도 작동)

### 7.2 Green Phase (구현 후)

- **TC-001**: ✅ PASS - `max` 속성이 `'2025-12-31'`로 설정됨
- **TC-002**: ✅ PASS - 모든 반복 유형에서 `max` 속성 확인됨
- **TC-003**: ✅ PASS - 반복 일정 생성 기능 정상 작동

---

## 8. 테스트 커버리지

### 8.1 커버리지 목표

- **라인 커버리지**: 100% (변경된 코드 1줄)
- **브랜치 커버리지**: N/A (조건문 없음)
- **함수 커버리지**: N/A (새로운 함수 없음)

### 8.2 커버리지 검증 방법

```bash
pnpm run test:coverage -- src/__tests__/unit/easy.repeatEndDateLimit.spec.ts
```

---

## 9. 테스트 실행 계획

### 9.1 실행 순서

1. **단위 테스트 먼저 실행**: TC-001, TC-002
2. **통합 테스트 실행**: TC-003

### 9.2 실행 명령어

```bash
# 전체 테스트 실행
pnpm run test

# 특정 테스트 파일만 실행
pnpm run test src/__tests__/unit/easy.repeatEndDateLimit.spec.ts

# Watch 모드로 실행
pnpm run test -- --watch
```

---

## 10. 테스트 유지보수 가이드

### 10.1 테스트 실패 시 대응

- **TC-001/TC-002 실패**: `App.tsx`의 반복 종료일 입력 필드에 `inputProps={{ max: '2025-12-31' }}` 추가 확인
- **TC-003 실패**: 기존 반복 일정 생성 로직에 문제가 있거나 Mock API 설정 확인 필요

### 10.2 향후 확장 시 고려사항

- 날짜 제한을 환경 변수로 관리하게 되면, 테스트 데이터도 환경 변수를 참조하도록 변경 필요
- 브라우저별 `max` 속성 동작 차이를 테스트하려면 E2E 테스트 추가 고려

---

## 11. 참조 문서

- `feature_spec.md`: 기능 명세서
- React Testing Library 문서: https://testing-library.com/docs/react-testing-library/intro/
- Vitest 문서: https://vitest.dev/
- Material-UI TextField 테스트: https://mui.com/material-ui/guides/testing/

---

## 12. 체크리스트 (Artemis)

- [x] 모든 기능 요구사항에 대한 테스트 케이스를 작성했는가?
- [x] 각 테스트 케이스의 목적과 예상 결과가 명확한가?
- [x] 테스트 케이스가 TDD Red-Green-Refactor 사이클에 적합한가?
- [x] 테스트 데이터가 충분하고 다양한가?
- [x] 테스트 환경 및 도구가 명확히 정의되었는가?
- [x] 테스트 구현 가이드라인이 구체적인가?
- [x] 예상 테스트 결과(Red/Green)를 명시했는가?
- [x] 테스트 커버리지 목표가 설정되었는가?
- [x] 테스트 유지보수 가이드가 포함되었는가?
- [x] 문서의 완전성과 명확성을 확인했는가?
